# Netlify Configuration for Librarian LLM
# This file configures how Netlify builds and serves your application

[build]
  # Command to build your React app
  command = "npm run build"

  # Directory containing the built files to serve
  publish = "dist"

  # Directory containing serverless functions
  functions = "netlify/functions"

[build.environment]
  # Node.js version for build environment
  NODE_VERSION = "18"

# Redirect API calls to serverless functions
# This makes /api/claude-chat route to /.netlify/functions/claude-chat
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

# Handle client-side routing for React SPA
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
  # Don't apply this rule to actual files or API routes
  conditions = {Role = ["*"]}
  force = false

# Configure serverless function settings
[functions]
  # Directory where functions are stored
  directory = "netlify/functions"

  # Function execution timeout (max 10 seconds on free tier)
  # Claude API typically responds in 2-5 seconds
  node_bundler = "esbuild"

# Development server configuration (for local testing with Netlify CLI)
[dev]
  command = "npm run dev"
  targetPort = 5173
  port = 8888
  publish = "dist"
  autoLaunch = false
